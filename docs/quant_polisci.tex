\PassOptionsToPackage{unicode=true}{hyperref} % options for packages loaded elsewhere
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[]{bxjsarticle}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\usepackage{fixltx2e} % provides \textsubscript
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provides euro and other symbols
\else % if luatex or xelatex
  \usepackage{unicode-math}
  \defaultfontfeatures{Ligatures=TeX,Scale=MatchLowercase}
\fi
% use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
% use microtype if available
\IfFileExists{microtype.sty}{%
\usepackage[]{microtype}
\UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\IfFileExists{parskip.sty}{%
\usepackage{parskip}
}{% else
\setlength{\parindent}{0pt}
\setlength{\parskip}{6pt plus 2pt minus 1pt}
}
\usepackage{hyperref}
\hypersetup{
            pdftitle={Rで計量政治学入門},
            pdfauthor={土井　翔平},
            pdfborder={0 0 0},
            breaklinks=true}
\urlstyle{same}  % don't use monospace font for urls
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{longtable,booktabs}
% Fix footnotes in tables (requires footnote package)
\IfFileExists{footnote.sty}{\usepackage{footnote}\makesavenoteenv{longtable}}{}
\usepackage{graphicx,grffile}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
\setlength{\emergencystretch}{3em}  % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{5}
% Redefines (sub)paragraphs to behave more like sections
\ifx\paragraph\undefined\else
\let\oldparagraph\paragraph
\renewcommand{\paragraph}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
\let\oldsubparagraph\subparagraph
\renewcommand{\subparagraph}[1]{\oldsubparagraph{#1}\mbox{}}
\fi

% set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother

\usepackage{booktabs}
\usepackage{amsthm}
\makeatletter
\def\thm@space@setup{%
  \thm@preskip=8pt plus 2pt minus 4pt
  \thm@postskip=\thm@preskip
}
\makeatother

\usepackage{zxjatype}
\setmainfont[BoldFont = Noto Serif CJK JP]{Noto Serif CJK JP Light}
\setsansfont[BoldFont = Noto Sans CJK JP]{Noto Sans CJK JP Light}
\setmonofont{Noto Sans Mono CJK JP}
\setCJKmainfont[BoldFont = Noto Serif CJK JP]{Noto Serif CJK JP Light}
\setCJKsansfont[BoldFont = Noto Sans CJK JP]{Noto Sans CJK JP Light}

\usepackage{xcolor}
\definecolor{main}{HTML}{53727d}

\usepackage{hyperref}
\hypersetup{
  colorlinks = true,
  allcolors = main,
  pdfauthor = {},
  pdftitle = {},
  pdfsubject = {},
  pdfkeywords = {}
}
\usepackage[]{natbib}
\bibliographystyle{apalike}

\title{Rで計量政治学入門}
\author{土井　翔平}
\date{2020-04-18}

\begin{document}
\maketitle

{
\setcounter{tocdepth}{2}
\tableofcontents
}
\hypertarget{index}{%
\section*{はじめに}\label{index}}
\addcontentsline{toc}{section}{はじめに}

本書はRによる計量政治学の入門レベルの講義資料です。
質問や間違いなどがありましたら、\href{mailto:shohei.doi0504@gmail.com}{ご連絡}を下さい。
筆者のプロフィールは\href{https://shohei-doi.github.io/}{こちら}をご覧ください。

\hypertarget{ux524dux63d0}{%
\subsection*{前提}\label{ux524dux63d0}}
\addcontentsline{toc}{subsection}{前提}

本書は、データ分析や数学の前提知識やプログラミング経験のない社会科学系学部生を主たる読者として想定しています。

\begin{itemize}
\tightlist
\item
  やや高度と思われる箇所には\texttt{*}を付けているので、読み飛ばしても構いません。
\end{itemize}

なお、RやRStudioのインストールについては\protect\hyperlink{install-r}{Rの環境構築}を、基本操作については\protect\hyperlink{intro-r}{Rプログラミング入門}をご覧ください。

\hypertarget{ux30a6ux30a7ux30d6ux30b5ux30a4ux30c8ux306eux64cdux4f5c}{%
\subsection*{ウェブサイトの操作}\label{ux30a6ux30a7ux30d6ux30b5ux30a4ux30c8ux306eux64cdux4f5c}}
\addcontentsline{toc}{subsection}{ウェブサイトの操作}

本書は\texttt{bookdown}を用いて作成しています。
ウェブサイトのナビゲーションバーでは、

\begin{itemize}
\tightlist
\item
  一番左のボタンで目次の表示・非表示の切り替え
\item
  虫眼鏡のマークで単語検索
\item
  Aのマークで文字の大きさ、フォント、色のコントロール
\item
  ダウンロードボタンで\texttt{.pdf}ファイルや\texttt{.epub}ファイルのダウンロード
\item
  iのマークでキーボードによる操作方法の表示
\end{itemize}

が可能です。

\hypertarget{part-ux30c7ux30fcux30bfux30cfux30f3ux30c9ux30eaux30f3ux30b0}{%
\part{データ・ハンドリング}\label{part-ux30c7ux30fcux30bfux30cfux30f3ux30c9ux30eaux30f3ux30b0}}

\hypertarget{data-import}{%
\section{データの読み込み}\label{data-import}}

本章ではデータを読み込む方法について解説します。

\hypertarget{ux4f7fux7528ux3059ux308bux30d1ux30c3ux30b1ux30fcux30b8}{%
\subsection{使用するパッケージ}\label{ux4f7fux7528ux3059ux308bux30d1ux30c3ux30b1ux30fcux30b8}}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(tidyverse)}
\end{Highlighting}
\end{Shaded}

\hypertarget{appendix-ux88dcux8ad6}{%
\appendix}


\hypertarget{install-r}{%
\section{Rの環境構築}\label{install-r}}

\hypertarget{intro-r}{%
\section{Rプログラミング入門}\label{intro-r}}

\hypertarget{ux95a2ux6570}{%
\subsection{関数}\label{ux95a2ux6570}}

\textbf{関数} (function) とは何かを入力すると、何かを出力するものです。
例えば、

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{print}\NormalTok{(}\StringTok{"Hello, World."}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "Hello, World."
\end{verbatim}

というコードは、\texttt{"Hello,\ World."}という文字列を\texttt{print()}という関数に入力し、その文字列を出力しています。

\begin{itemize}
\tightlist
\item
  Rでは、関数は\texttt{関数名()}という形を取ります。
\item
  入力するものを入力引数 (input argument) 、出力するものを出力引数 (output argument) と呼んだりします。
\end{itemize}

次のように、入力引数も出力引数も1つとは限りません。

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{rnorm}\NormalTok{(}\DataTypeTok{n =} \DecValTok{10}\NormalTok{, }\DataTypeTok{mean =} \DecValTok{0}\NormalTok{, }\DataTypeTok{sd =} \DecValTok{1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1]  2.23694629 -1.42591525  0.45572591  2.31848015 -0.14039099 -0.31960941
##  [7]  0.21278761  1.10877640 -0.01808161  0.29574498
\end{verbatim}

さて、この関数は何をしているのでしょうか。
Rでは、関数名の前に\texttt{?}をつけて実行することで、その関数のヘルプを見ることができます。

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{?rnorm}
\end{Highlighting}
\end{Shaded}

英語で関数の使い方が解説されていますが、\texttt{rnorm(n\ =\ 10,\ mean\ =\ 0,\ sd\ =\ 1)}は平均0、標準偏差1の（標準）正規分布に従う乱数を10個だけ生じさせています。

入力引数は\texttt{=}で明示的に指定する場合、どのような順番でも構いません。

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{rnorm}\NormalTok{(}\DataTypeTok{mean =} \DecValTok{0}\NormalTok{, }\DataTypeTok{sd =} \DecValTok{1}\NormalTok{, }\DataTypeTok{n =} \DecValTok{10}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

入力引数を明示的に指定しない場合、ヘルプにある順番で入力します。
以下の例は上述のものと同じです。

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{rnorm}\NormalTok{(}\DecValTok{10}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

また、ヘルプで\texttt{mean\ =\ 0,\ sd\ =\ 1}のように書かれている場合、デフォルトが定められています。
実行者が入力引数を指定しない限り、デフォルト値が使用されます。
したがって、以下の例もこれまでと同じコードです。
ｘ

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{rnorm}\NormalTok{(}\DecValTok{10}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{ux30aaux30d6ux30b8ux30a7ux30afux30c8}{%
\subsection{オブジェクト}\label{ux30aaux30d6ux30b8ux30a7ux30afux30c8}}

Rでは\texttt{\textless{}-}でオブジェクトを作成することができます。
例えば、100個の正規分布に従う乱数を\texttt{x}という名前のオブジェクトとして作成します。

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x <-}\StringTok{ }\KeywordTok{rnorm}\NormalTok{(}\DecValTok{100}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  RStudioでは\texttt{\textless{}-}はショートカット\texttt{Alt\ +\ -}で入力できます。
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   [1] -0.20889880 -1.86376391  0.19795533 -0.80019378  0.01445068  0.55426108
##   [7]  1.33811157  0.77747237 -0.84586215 -0.93898185 -0.16866126  0.51944060
##  [13]  1.38603432  0.09171076  0.05158738  0.09910025  0.01845770 -0.96575997
##  [19] -0.44045888 -0.07515398  1.21712082 -0.55510386 -1.40260876 -1.56040204
##  [25] -0.58568727 -0.42203145  0.92065283 -1.42672918 -1.40223991 -0.27751328
##  [31]  0.25589247 -1.01434222 -0.48042818 -0.62363329 -0.81061236 -0.47470524
##  [37]  0.01431438  1.13046028  0.51462702 -2.00475867  1.30627037 -0.40754690
##  [43] -1.06893328  0.76913464  1.10008479 -0.40882094  0.26572687  0.05836558
##  [49] -1.46337650  0.48654955  0.26557291  0.34609291 -0.16930373 -1.61076615
##  [55] -1.43983470  0.13883513  0.63851187 -1.37661568 -0.26226845 -0.64570202
##  [61]  1.79275463  0.59505310 -0.67871684 -0.61613256 -1.80631192 -0.77713265
##  [67]  1.14519440 -0.06030078  0.14024331  1.14049217 -0.35877181  0.97572225
##  [73] -0.53049467 -1.96994718 -1.44090695  2.44495408  0.35773239  2.70824287
##  [79]  0.13738775 -0.29876660 -2.26422660 -0.83171134 -0.22360298 -0.01766579
##  [85] -1.82978039  1.09803014 -1.37299345  0.94935250  0.35321484 -0.82226275
##  [91]  0.30189825  0.78473821 -0.49667435  0.60030312  0.08538829 -0.51265359
##  [97]  1.36679425  0.15855473 -1.62271227 -0.50188863
\end{verbatim}

実際に、乱数が\texttt{x}に格納されていることが分かります。

オブジェクトを入力引数とすることも可能です。
\texttt{x}の平均と標準偏差を求めてみます。

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{mean}\NormalTok{(x)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] -0.1562251
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{sd}\NormalTok{(x)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.9873311
\end{verbatim}

もちろん、出力引数を新しいオブジェクトにすることもできます。

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x.mean <-}\StringTok{ }\KeywordTok{mean}\NormalTok{(x)}
\NormalTok{x.mean}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] -0.1562251
\end{verbatim}

\begin{itemize}
\tightlist
\item
  オブジェクトの名前にはアルファベットと数字、\texttt{.}と\texttt{\_}が使えます。
\item
  ただし、数字は最初の文字としては使えません。
\end{itemize}

オブジェクトは上書きすることもできます。

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x.mean <-}\StringTok{ }\KeywordTok{mean}\NormalTok{(}\KeywordTok{rnorm}\NormalTok{(}\DecValTok{100}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\hypertarget{ux30d1ux30c3ux30b1ux30fcux30b8}{%
\subsection{パッケージ}\label{ux30d1ux30c3ux30b1ux30fcux30b8}}

大雑把に言って、Rによるデータ分析は\textbf{データをオブジェクトとして読み込み、いろいろな関数で処理を行うこと}で実行します。

つまり、関数が重要なのですが、Rで標準に備わっている関数には限界があります。
そこで、様々な研究者が関数を作成し、それをまとめたものを\textbf{パッケージ}として公開しています。

\begin{itemize}
\tightlist
\item
  基本的に、\href{https://cran.r-project.org/}{CRAM}でパッケージは公開されます。
\end{itemize}

パッケージをインストールするには、\texttt{install.packages()}という関数にパッケージ名を入れて実行します。
試しに、\href{https://www.tidyverse.org/}{Tidyverse}という幅広く使われているパッケージをインストールしてみます。

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{install.packages}\NormalTok{(}\StringTok{"tidyverse"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  RStudioの場合、\texttt{Packages}パネル（デフォルトの場合は右下）の中に\texttt{Install}というボタンがあり、そこにパッケージ名を入力していインストールすることも可能です。
\end{itemize}

\texttt{"}でパッケージ名を囲まないとエラーになります。

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{install.packages}\NormalTok{(tidyverse)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Error in install.packages(tidyverse): object 'tidyverse' not found
\end{verbatim}

インストールしたパッケージに対して再び\texttt{install.packages()}を行うと、最新版にアップデートされます。

\begin{itemize}
\tightlist
\item
  RStudioの場合、\texttt{Packages}パネルに\texttt{Update}というボタンがあり、アップデートできるパッケージを自動検索してくれます。
\end{itemize}

パッケージはインストールしただけでは使用することはできず、\texttt{library()}で読み込む必要があります。

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(tidyverse)}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  この場合は\texttt{"}で囲む必要はありません。
\item
  インストールは一回で十分です。
\end{itemize}

RStudioであれば\texttt{Packages}パネルにインストール済みのパッケージ一覧があるので、パッケージ名をクリックすると含まれる関数一覧を見ることができます。

\begin{itemize}
\tightlist
\item
  同様のものは\href{https://cran.r-project.org/}{CRAM}でも\texttt{pdf}形式で見ることができます。
\item
  一部のソフトウェアは\href{https://www.jstatsoft.org/index}{Journal of Statistical Software}などで論文が公開されています。
\end{itemize}

\hypertarget{tidyverseux3068ux306f}{%
\subsubsection{Tidyverseとは}\label{tidyverseux3068ux306f}}

\hypertarget{rux30b9ux30afux30eaux30d7ux30c8}{%
\subsection{Rスクリプト}\label{rux30b9ux30afux30eaux30d7ux30c8}}

\hypertarget{rux30d7ux30edux30b8ux30a7ux30afux30c8}{%
\subsection{Rプロジェクト}\label{rux30d7ux30edux30b8ux30a7ux30afux30c8}}

\hypertarget{ux95a2ux6570ux306eux4f5cux6210}{%
\subsection{関数の作成}\label{ux95a2ux6570ux306eux4f5cux6210}}

Rで関数を自作する際は\texttt{function()\{\}}という関数を使います。

\begin{itemize}
\tightlist
\item
  \texttt{()}の中に入力引数を記述します。
\item
  \texttt{\{\}}の中に処理内容を記述し、最後に\texttt{return()}で出力引数を指定します。
\end{itemize}

例えば、数値ベクトルを入力引数として、平均と標準偏差を出力引数とする関数を作成します。

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mean_sd <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(x) \{ }\CommentTok{# 入力引数の名前をxとしておきます。}
\NormalTok{  mean.x <-}\StringTok{ }\KeywordTok{mean}\NormalTok{(x) }\CommentTok{# 平均を計算します。}
\NormalTok{  sd.x <-}\StringTok{ }\KeywordTok{sd}\NormalTok{(x) }\CommentTok{# 標準偏差を計算します。}
  \KeywordTok{return}\NormalTok{(}\KeywordTok{c}\NormalTok{(mean.x, sd.x)) }\CommentTok{# 出力引数を指定します。}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

実際に実行してみます。

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x <-}\StringTok{ }\KeywordTok{rnorm}\NormalTok{(}\DecValTok{100}\NormalTok{)}
\KeywordTok{mean_sd}\NormalTok{(x)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] -0.1060836  0.7926911
\end{verbatim}

\hypertarget{ux30ebux30fcux30d7}{%
\subsection{ループ}\label{ux30ebux30fcux30d7}}

\textbf{ループ}とは同一の処理を複数回実行することを指します。
例えば、100個の標準正規分布に従う乱数の平均を5回求める処理は次のようになります。

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\DecValTok{5}\NormalTok{) \{}
  \KeywordTok{print}\NormalTok{(}\KeywordTok{mean}\NormalTok{(}\KeywordTok{rnorm}\NormalTok{(}\DecValTok{100}\NormalTok{)))}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] -0.1534651
## [1] -3.82378e-05
## [1] -0.02272271
## [1] -0.04087669
## [1] -0.07586265
\end{verbatim}

\texttt{for}ループとは\texttt{()}の中の\texttt{in}のあとのベクトルの第1要素から順番に\texttt{i}に代入して繰り返しています。
そのことは、次の例から解ると思います。

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{head}\NormalTok{(letters)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "a" "b" "c" "d" "e" "f"
\end{verbatim}

\begin{itemize}
\tightlist
\item
  \texttt{letters}とはアルファベットのベクトルです。
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \KeywordTok{head}\NormalTok{(letters)) \{}
  \KeywordTok{print}\NormalTok{(i)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "a"
## [1] "b"
## [1] "c"
## [1] "d"
## [1] "e"
## [1] "f"
\end{verbatim}

\begin{itemize}
\tightlist
\item
  \texttt{for}ループとは別に、特定の条件が満たされるまで繰り返される\texttt{while}ループもあります。
\end{itemize}

ループ処理の結果を格納するには少しテクニックが必要です。
100個の乱数の平均を5回取ったものを\texttt{x}として保存したいとします。

まず、\texttt{x}を\texttt{NULL}オブジェクトとして作成します。

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x <-}\StringTok{ }\OtherTok{NULL}
\NormalTok{x}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## NULL
\end{verbatim}

\begin{itemize}
\tightlist
\item
  \texttt{NULL}とは空っぽのオブジェクト（0という数値や空白という文字ではない）です。
\end{itemize}

先程のループ処理の中で、計算した平均を\texttt{c()}で\texttt{x}にくっつけていきます。

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\DecValTok{5}\NormalTok{) \{}
\NormalTok{  x <-}\StringTok{ }\KeywordTok{c}\NormalTok{(x, }\KeywordTok{mean}\NormalTok{(}\KeywordTok{rnorm}\NormalTok{(}\DecValTok{100}\NormalTok{)))}
\NormalTok{\}}
\NormalTok{x}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1]  0.03028653  0.07979142  0.06808259  0.18159205 -0.08314063
\end{verbatim}

無事、5個の平均値が\texttt{x}に保存されていることがわかります。

実際に\texttt{for}ループの中で何が起こっているかは、次のコードで解ると思います。

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x <-}\StringTok{ }\OtherTok{NULL}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\DecValTok{5}\NormalTok{) \{}
\NormalTok{  x <-}\StringTok{ }\KeywordTok{c}\NormalTok{(x, }\KeywordTok{mean}\NormalTok{(}\KeywordTok{rnorm}\NormalTok{(}\DecValTok{100}\NormalTok{)))}
  \KeywordTok{print}\NormalTok{(x)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.06329371
## [1] 0.06329371 0.03491014
## [1]  0.06329371  0.03491014 -0.13799852
## [1]  0.06329371  0.03491014 -0.13799852  0.08900250
## [1]  0.06329371  0.03491014 -0.13799852  0.08900250 -0.10675900
\end{verbatim}

\begin{itemize}
\tightlist
\item
  ループが一周するたびに、前回の\texttt{x}に新しい要素が付け加わり、新しい\texttt{x}として保存されています。
\end{itemize}

\texttt{NULL}オブジェクトを使ったループ結果の保存でよくあるミスは、やり直す際に\texttt{NULL}でリセットするのを忘れることです。
例えば、同じコードをもう一度実行しましょう。

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\DecValTok{5}\NormalTok{) \{}
\NormalTok{  x <-}\StringTok{ }\KeywordTok{c}\NormalTok{(x, }\KeywordTok{mean}\NormalTok{(}\KeywordTok{rnorm}\NormalTok{(}\DecValTok{100}\NormalTok{)))}
\NormalTok{\}}
\NormalTok{x}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1]  0.063293709  0.034910144 -0.137998525  0.089002497 -0.106759002
##  [6]  0.169033172 -0.190421497 -0.039464623  0.060452355 -0.005830551
\end{verbatim}

\begin{itemize}
\tightlist
\item
  \texttt{x}に10個の平均値が入っています。
\end{itemize}

このようなミスを避ける方法の一つは、全体を関数として作成することです。

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{multi_mean <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{() \{}
\NormalTok{  x <-}\StringTok{ }\OtherTok{NULL}
  \ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\DecValTok{5}\NormalTok{) \{}
\NormalTok{    x <-}\StringTok{ }\KeywordTok{c}\NormalTok{(x, }\KeywordTok{mean}\NormalTok{(}\KeywordTok{rnorm}\NormalTok{(}\DecValTok{100}\NormalTok{)))}
\NormalTok{  \}}
  \KeywordTok{return}\NormalTok{(x)}
\NormalTok{\}}
\NormalTok{x <-}\StringTok{ }\KeywordTok{multi_mean}\NormalTok{()}
\NormalTok{x}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1]  0.153940109 -0.046517411 -0.044633540  0.003634741  0.114242271
\end{verbatim}

\hypertarget{ux6761ux4ef6ux5206ux5c90}{%
\subsection{条件分岐}\label{ux6761ux4ef6ux5206ux5c90}}

\textbf{条件分岐}とは、特定の条件の場合に特定の動作を行うようにすることです。
例えば、正の場合\texttt{positive}、負の場合\texttt{negative}と出力するコマンドは次のようになります。

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x <-}\StringTok{ }\KeywordTok{rnorm}\NormalTok{(}\DecValTok{1}\NormalTok{)}
\ControlFlowTok{if}\NormalTok{ (x }\OperatorTok{>}\StringTok{ }\DecValTok{0}\NormalTok{) \{}
  \KeywordTok{print}\NormalTok{(}\StringTok{"positive"}\NormalTok{)}
\NormalTok{\} }\ControlFlowTok{else}\NormalTok{ \{}
  \KeywordTok{print}\NormalTok{(}\StringTok{"negative"}\NormalTok{)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "negative"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{print}\NormalTok{(x)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] -0.5722284
\end{verbatim}

\begin{itemize}
\tightlist
\item
  \texttt{if()\{\}}の\texttt{()}の中に条件式を書き、\texttt{\{\}}の中に処理内容を書きます。
\item
  それ以外の条件は\texttt{else}で示します。
\end{itemize}

条件式は3つ以上でも構いません。

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x <-}\StringTok{ }\KeywordTok{rnorm}\NormalTok{(}\DecValTok{1}\NormalTok{)}
\ControlFlowTok{if}\NormalTok{ (x }\OperatorTok{>}\StringTok{ }\FloatTok{-0.5}\NormalTok{) \{}
  \KeywordTok{print}\NormalTok{(}\StringTok{"x is less than -0.5."}\NormalTok{)}
\NormalTok{\} }\ControlFlowTok{else} \ControlFlowTok{if}\NormalTok{ (x }\OperatorTok{>=}\StringTok{ }\FloatTok{-0.5} \OperatorTok{&}\StringTok{ }\NormalTok{x }\OperatorTok{<=}\StringTok{ }\FloatTok{0.5}\NormalTok{) \{}
  \KeywordTok{print}\NormalTok{(}\StringTok{"x is between -0.5 and 0.5."}\NormalTok{)}
\NormalTok{\} }\ControlFlowTok{else}\NormalTok{ \{}
  \KeywordTok{print}\NormalTok{(}\StringTok{"x is more than 0.5.ー"}\NormalTok{)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "x is less than -0.5."
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{print}\NormalTok{(x)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.2696406
\end{verbatim}

\begin{itemize}
\tightlist
\item
  \texttt{\&}は「かつ」を意味します。
\item
  「または」は\texttt{\textbar{}}を使います。
\item
  \texttt{\textgreater{}=}は \(\geq\) を意味します。
\item
  「同じ値である」は\texttt{==}を使います（\texttt{=}ではない点に注意）。
\end{itemize}

\hypertarget{ux7df4ux7fd2ux554fux984cux30d5ux30a3ux30dcux30caux30c3ux30c1ux6570ux5217}{%
\subsection{練習問題：フィボナッチ数列}\label{ux7df4ux7fd2ux554fux984cux30d5ux30a3ux30dcux30caux30c3ux30c1ux6570ux5217}}

フィボナッチ数列とは以下の条件を満たす数列です。

\[
\begin{aligned}
  F_0 &= 0 \\
  F_1 &= 1 \\
  F_{n} &= F_{n-1} + F_{n-2} \quad n \geq 2
\end{aligned}
\]

例えば、

\[
\begin{aligned}
  F_2 = 1, F_3 = 2, F_4 = 3, F_5 = 5, F_6 = 8,\ldots
\end{aligned}
\]

となります。

フィボナッチ数列の第\(n\)項を（解析解を使わずに）求める関数を作成してみて下さい。

\hypertarget{ux7df4ux7fd2ux554fux984cux30e2ux30f3ux30c6ux30abux30ebux30edux30b7ux30dfux30e5ux30ecux30fcux30b7ux30e7ux30f3}{%
\subsection{練習問題：モンテカルロ・シミュレーション}\label{ux7df4ux7fd2ux554fux984cux30e2ux30f3ux30c6ux30abux30ebux30edux30b7ux30dfux30e5ux30ecux30fcux30b7ux30e7ux30f3}}

モンテカルロ・シミュレーション（モンテカルロ法）とは乱数を用いて近似解を求める手法です。

例えば、円周率\(\pi\)の近似解は以下のように求めることができます。

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  0以上1未満の一様分布から\(n\)個の乱数\(x_i\)と\(n\)個の乱数\(y_i\)を発生させます (\(i = 1,2,\ldots,n\)) 。
\item
  原点と\((x_i,y_i)\)の距離が1以下である回数を計算し\(n_1\)とします。
\item
  円周率の近似解として\(\hat{\pi} = 4 \times n_1/n\)を得ます。
\end{enumerate}

モンテカルロ・シミュレーションによる円周率の近似解を求める関数を作成してみて下さい。

また、モンテカルロ・シミュレーションによる円周率の近似解を\(m\)回求めて、その平均値や標準偏差が\(n\)によってどのように変化するか検討してみて下さい。

\hypertarget{environment}{%
\section*{動作環境}\label{environment}}
\addcontentsline{toc}{section}{動作環境}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{sessionInfo}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## R version 3.6.3 (2020-02-29)
## Platform: x86_64-pc-linux-gnu (64-bit)
## Running under: Ubuntu 18.04.4 LTS
## 
## Matrix products: default
## BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.7.1
## LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.7.1
## 
## locale:
##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 
##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            
## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] forcats_0.5.0   stringr_1.4.0   dplyr_0.8.5     purrr_0.3.3    
## [5] readr_1.3.1     tidyr_1.0.2     tibble_3.0.0    ggplot2_3.3.0  
## [9] tidyverse_1.3.0
## 
## loaded via a namespace (and not attached):
##  [1] tidyselect_1.0.0 xfun_0.13        haven_2.2.0      lattice_0.20-41 
##  [5] colorspace_1.4-1 vctrs_0.2.4      generics_0.0.2   htmltools_0.4.0 
##  [9] yaml_2.2.1       rlang_0.4.5      pillar_1.4.3     withr_2.1.2     
## [13] glue_1.4.0       DBI_1.1.0        dbplyr_1.4.2     modelr_0.1.6    
## [17] readxl_1.3.1     lifecycle_0.2.0  munsell_0.5.0    gtable_0.3.0    
## [21] cellranger_1.1.0 rvest_0.3.5      evaluate_0.14    knitr_1.28      
## [25] fansi_0.4.1      broom_0.5.5      Rcpp_1.0.4.6     backports_1.1.6 
## [29] scales_1.1.0     jsonlite_1.6.1   fs_1.4.1         hms_0.5.3       
## [33] digest_0.6.25    stringi_1.4.6    bookdown_0.18    grid_3.6.3      
## [37] cli_2.0.2        tools_3.6.3      magrittr_1.5     crayon_1.3.4    
## [41] pkgconfig_2.0.3  ellipsis_0.3.0   xml2_1.3.1       reprex_0.3.0    
## [45] lubridate_1.7.8  assertthat_0.2.1 rmarkdown_2.1    httr_1.4.1      
## [49] rstudioapi_0.11  R6_2.4.1         nlme_3.1-144     compiler_3.6.3
\end{verbatim}

\bibliography{book.bib,packages.bib}

\end{document}
